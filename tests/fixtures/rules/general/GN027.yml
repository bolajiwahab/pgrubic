---
rule: GN027

test_fail_yoda_condition_equal_to:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 = city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id = 10;

test_fail_yoda_condition_not_equal_to:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 != city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id <> 10;

test_fail_yoda_condition_greater_than:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 > city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id < 10;

test_fail_yoda_condition_less_than:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 < city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id > 10;

test_fail_yoda_condition_greater_than_or_equal_to:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 >= city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id <= 10;

test_fail_yoda_condition_less_than_or_equal_to:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 <= city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id >= 10;

test_fail_yoda_condition_equal_to_qualified_operator:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 OPERATOR(pg_catalog.=) city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id OPERATOR(pg_catalog.=) 10;

test_fail_yoda_condition_not_equal_to_qualified_operator:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 OPERATOR(pg_catalog.!=) city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id OPERATOR(pg_catalog.<>) 10;

test_fail_yoda_condition_greater_than_qualified_operator:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 OPERATOR(pg_catalog.>) city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id OPERATOR(pg_catalog.<) 10;

test_fail_yoda_condition_less_than_qualified_operator:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 OPERATOR(pg_catalog.<) city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id OPERATOR(pg_catalog.>) 10;

test_fail_yoda_condition_greater_than_or_equal_to_qualified_operator:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 OPERATOR(pg_catalog.>=) city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id OPERATOR(pg_catalog.<=) 10;

test_fail_yoda_condition_less_than_or_equal_to_qualified_operator:
  sql_fail: |
    SELECT * FROM measurement WHERE 10 OPERATOR(pg_catalog.<=) city_id;
  sql_fix: |
    SELECT *
      FROM measurement
     WHERE city_id OPERATOR(pg_catalog.>=) 10;

test_pass_yoda_condition_with_constants:
  sql_pass: |
    SELECT * FROM measurement WHERE 10 = 10;

test_pass_normal_condition:
  sql_pass: |
    SELECT * FROM measurement WHERE city_id = 10;
